package uk.co.ciaranmoran.chip8;

public class Main {
    public static void main(String[] args) {
        final int CLOCK = 1000;
        final long PERIOD = 1000000000 / CLOCK;
        final int[] font = {
                0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
                0x20, 0x60, 0x20, 0x20, 0x70, // 1
                0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
                0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
                0x90, 0x90, 0xF0, 0x10, 0x10, // 4
                0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
                0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
                0xF0, 0x10, 0x20, 0x40, 0x40, // 7
                0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
                0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
                0xF0, 0x90, 0xF0, 0x90, 0x90, // A
                0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
                0xF0, 0x80, 0x80, 0x80, 0xF0, // C
                0xE0, 0x90, 0x90, 0x90, 0xE0, // D
                0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
                0xF0, 0x80, 0xF0, 0x80, 0x80  // F
        };

        Chip8 chip8 = new Chip8();
        int[] program = {0x00, 0xE0, 0x60, 0x00, 0x61, 0x3E, 0x62, 0x1E, 0xF0, 0x29, 0xD1, 0x25, 0x12, 0x00};
        chip8.loadProgram(args[0]);
        chip8.loadFont(font);

        long start = System.nanoTime();
        long dt;
        while (true) {
            dt = (System.nanoTime() - start);
            if (dt >= PERIOD) {
                start = System.nanoTime();
                chip8.clock((int) (dt / PERIOD));
            }
        }
    }
}